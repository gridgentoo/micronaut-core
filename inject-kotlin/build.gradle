plugins {
    id 'java'
    id "org.jetbrains.kotlin.jvm"
}

dependencies {
    api project(":inject")
    api project(':aop')

    implementation("com.google.devtools.ksp:symbol-processing-api:1.6.0-1.0.1")
    if (!JavaVersion.current().isJava9Compatible()) {
        api files(org.gradle.internal.jvm.Jvm.current().toolsJar)
    }
    testImplementation("com.github.tschuchortdev:kotlin-compile-testing-ksp:1.4.6")
    testImplementation libs.kotlin.stdlib
    testImplementation libs.managed.jackson.annotations
    testImplementation libs.managed.validation
}

afterEvaluate {
    sourcesJar {
        from "$projectDir/src/main/kotlin"
    }
}

tasks.named("test") {
    classpath += files(tasks.compileTestKotlin)
}
